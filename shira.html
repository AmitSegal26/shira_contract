<!DOCTYPE html>

<html lang="en" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Digital Signature</title>

    <style>
      /* ===== Base Styles ===== */
      * {
        box-sizing: border-box;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
      }

      body {
        margin: 0;
        padding: 0;
        background: #f4f6f8;
        color: #333;
      }

      .container {
        max-width: 720px;
        margin: 0 auto;
        padding: 24px;
      }

      .card {
        background: #ffffff;
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        padding: 24px;
      }

      h1 {
        text-align: center;
        margin: 0 0 12px;
        font-size: 28px;
      }

      p.description {
        text-align: center;
        margin: 0 0 24px;
        color: #666;
        font-size: 16px;
      }

      /* ===== Image Section ===== */
      .image-wrapper {
        width: 50%;
        margin-bottom: 24px;
      }

      .image-wrapper img {
        width: 100%;
        height: auto;
        border-radius: 12px;
        display: block;
      }

      /* ===== Signature Section ===== */
      .signature-section {
        margin-top: 16px;
      }

      .signature-label {
        font-weight: 600;
        margin-bottom: 8px;
        display: block;
      }

      .canvas-wrapper {
        border: 2px dashed #ccc;
        border-radius: 12px;
        overflow: hidden;
        touch-action: none; /* Prevent scrolling while drawing */
      }

      canvas {
        width: 100%;
        height: 200px;
        display: block;
        background: #fafafa;
      }

      .buttons {
        display: flex;
        gap: 12px;
        margin-top: 16px;
        flex-wrap: wrap;
      }

      button {
        flex: 1;
        min-width: 140px;
        padding: 12px 16px;
        border: none;
        border-radius: 10px;
        font-size: 15px;
        cursor: pointer;
        transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.2s;
      }

      button:active {
        transform: translateY(1px);
      }

      .clear-btn {
        background: #f1f3f5;
        color: #333;
      }

      .clear-btn:hover {
        background: #e6e8eb;
      }

      .save-btn {
        background: #2563eb;
        color: #ffffff;
        box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
      }

      .save-btn:hover {
        background: #1d4ed8;
      }

      @media (max-width: 480px) {
        h1 {
          font-size: 24px;
        }

        canvas {
          height: 180px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="card">
        <h1>טופס לחתימה</h1>
        <p class="description">
          בהתאם לצ'אט שהתנהל בוואצפ אני מבקש חתימה שמאשרת את התקנון
        </p>

        ```
        <div class="image-wrapper">
          <img src="./shira_and_me.jpeg" alt="Document Preview" />
        </div>

        <div class="signature-section">
          <span class="signature-label">חתמי כאן, אני אוהב אותך ♥</span>
          <br />
          <span class="signature-label">צלמי מסך ושלחי</span>

          <div class="canvas-wrapper">
            <canvas id="signatureCanvas"></canvas>
          </div>

          <div class="buttons">
            <button class="clear-btn" id="clearBtn">נקה חתימה</button>
          </div>
        </div>
      </div>
      ```
    </div>

    <script>
      const canvas = document.getElementById("signatureCanvas");
      const ctx = canvas.getContext("2d");

      let isDrawing = false;
      let lastX = 0;
      let lastY = 0;

      function resizeCanvas() {
        const ratio = window.devicePixelRatio || 1;
        const rect = canvas.getBoundingClientRect();

        canvas.width = rect.width * ratio;
        canvas.height = rect.height * ratio;

        ctx.scale(ratio, ratio);
        ctx.lineCap = "round";
        ctx.lineJoin = "round";
        ctx.lineWidth = 2;
        ctx.strokeStyle = "#111";
      }

      window.addEventListener("resize", resizeCanvas);
      resizeCanvas();

      function getPosition(event) {
        const rect = canvas.getBoundingClientRect();

        if (event.touches && event.touches.length > 0) {
          return {
            x: event.touches[0].clientX - rect.left,
            y: event.touches[0].clientY - rect.top,
          };
        }

        return {
          x: event.clientX - rect.left,
          y: event.clientY - rect.top,
        };
      }

      function startDrawing(event) {
        event.preventDefault();
        isDrawing = true;
        const pos = getPosition(event);
        lastX = pos.x;
        lastY = pos.y;
      }

      function draw(event) {
        if (!isDrawing) return;
        event.preventDefault();

        const pos = getPosition(event);
        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();

        lastX = pos.x;
        lastY = pos.y;
      }

      function stopDrawing(event) {
        event.preventDefault();
        isDrawing = false;
      }

      canvas.addEventListener("mousedown", startDrawing);
      canvas.addEventListener("mousemove", draw);
      canvas.addEventListener("mouseup", stopDrawing);
      canvas.addEventListener("mouseleave", stopDrawing);

      canvas.addEventListener("touchstart", startDrawing, { passive: false });
      canvas.addEventListener("touchmove", draw, { passive: false });
      canvas.addEventListener("touchend", stopDrawing);

      document.getElementById("clearBtn").addEventListener("click", () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      });

      document.getElementById("saveBtn").addEventListener("click", () => {
        const dataURL = canvas.toDataURL("image/png");
        const link = document.createElement("a");
        link.href = dataURL;
        link.download = "signature.png";
        link.click();
      });
    </script>
  </body>
</html>
